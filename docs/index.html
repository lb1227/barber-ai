<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Barber AI – Availability & Blackouts</title>
<style>
  :root{
    --bg:#0f1115;
    --panel:#171a21;
    --muted:#8a93a6;
    --text:#e7ecf7;
    --accent:#4f8cff;
    --accent-2:#5dd29b;
    --danger:#ff6b6b;
    --grid:#232736;
    --chip:#222637;
  }
  *{box-sizing:border-box}
  body{
    margin:0;background:var(--bg);color:var(--text);
    font:14px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial;
  }
  header{
    padding:18px 20px;border-bottom:1px solid #1d2030;background:var(--panel);
    display:flex;gap:14px;align-items:center;flex-wrap:wrap;position:top:0;z-index:3;
  }
  header h1{font-size:16px;margin:0 10px 0 0;letter-spacing:.2px;opacity:.95}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .ctrl{
    display:flex;flex-direction:column;gap:6px;background:var(--chip);
    padding:10px 12px;border-radius:10px;border:1px solid #262b3e;min-width:140px;
  }
  .ctrl label{font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.6px}
  .ctrl input[type="time"], .ctrl select{
    background:#111420;color:var(--text);border:1px solid #2c3147;border-radius:8px;
    padding:7px 8px;outline:none;
  }
  button{
    background:var(--accent);color:white;border:none;border-radius:10px;
    padding:10px 14px;font-weight:600;cursor:pointer;
  }
  button.secondary{background:#28304a;color:#d6dcf0}
  button.danger{background:var(--danger)}
  main{display:grid;grid-template-columns:1.55fr .95fr;gap:18px;padding:18px;max-width:1280px;margin:0 auto}
  @media (max-width:1000px){main{grid-template-columns:1fr;}}
  .card{
    background:var(--panel);border:1px solid #23273a;border-radius:14px;overflow:hidden;
  }
  .card header{
    display:flex;justify-content:space-between;align-items:center;background:#131722;border-bottom:1px solid #21263a;
    padding:12px 14px;position:unset;
  }
  .card header h2{margin:0;font-size:14px;letter-spacing:.2px}
  .hint{color:var(--muted);font-size:12px}
  /* WEEK GRID */
  .week-wrap{overflow:auto}
  .week{
    display:grid;grid-template-columns:70px repeat(7,1fr);min-width:880px;grid-auto-flow: row;
  }

  .day-head,.time-cell{
    background:#131722;border-bottom:1px solid #1f2436;position:sticky;top:0;z-index:2;
  }
  .day-head{padding:8px 10px;text-align:center;border-left:1px solid #1f2436}
  .day-head .dow{font-size:12px;color:var(--muted)}
  .day-head .date{font-weight:700}
  .time-col{background:#111420;border-right:1px solid #1f2436}
  .time-label{
    height:40px;display:flex;align-items:flex-start;justify-content:flex-end;padding:2px 8px;color:var(--muted);
    border-bottom:1px dashed #1e2435;font-size:12px
  }
  .slots{
    display:grid;border-right:1px solid #1f2436;grid-auto-rows:20px;background:#0f1220;
  }
  .slot{
    border-bottom:1px solid var(--grid);cursor:pointer;position:relative;
  }
  .slot:hover{ background:#2a1515; }
  .slot.active {
    background: linear-gradient(180deg, #5a1c1c, #3d0f0f); /* red tones */
    border-color: #7e303a;
    box-shadow: inset 0 0 0 1px #a33b3b;
  }
  .slot.blocked{background:#2a1515;color:#d9a2a2;cursor:not-allowed;opacity:.55}
  .tag{
    position:absolute;right:6px;top:2px;font-size:10px;color:#cfe3ff;opacity:.8
  }
  /* MONTH CAL */
  .month-controls{
    display:flex;gap:8px;align-items:center
  }
  .month-grid{
    display:grid;grid-template-columns:repeat(7,1fr);border-top:1px solid #22263b;border-left:1px solid #22263b
  }
  .cell{
    min-height:78px;border-right:1px solid #22263b;border-bottom:1px solid #22263b;padding:8px;position:relative;
    background:#0f1220;cursor:pointer;
  }
  .cell .d{position:absolute;top:6px;right:8px;color:var(--muted);font-size:12px}
  .cell.dim{opacity:.5}
  .cell.blockout{background:#2a171a;outline:2px solid #4a1c22}
  .legend{display:flex;gap:10px;font-size:12px;color:var(--muted)}
  .legend .chip{display:inline-flex;align-items:center;gap:6px}
  .legend .dot{width:14px;height:14px;border-radius:4px;display:inline-block;background:#213259;border:1px solid #3c5aa9}
  .legend .dot.block{background:#4a1c22;border-color:#7e303a}
  /* red chip for "Unavailable slot" */
  .legend .dot.unavail{
    background:#5a1c1c;
    border-color:#a33b3b;
  }
  footer{
    max-width:1280px;margin:12px auto 28px;padding:0 18px;color:var(--muted);display:flex;justify-content:space-between;gap:12px;flex-wrap:wrap
  }
  .inline-actions{display:flex;gap:8px;flex-wrap:wrap}
  textarea#import{
    width:100%;min-height:120px;background:#0e1220;border:1px solid #243054;color:#e6edff;border-radius:10px;padding:10px
  }
  .month-dow{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  border-left:1px solid #22263b;
  border-top:1px solid #22263b;
  background:#131722;
}
  /* weekday header buttons */
.month-dow .dow-btn{
  width:100%;
  background:#0f1220;
  color:#cfd6ea;
  border:none;
  border-right:1px solid #22263b;
  border-bottom:1px solid #22263b;
  padding:8px 0;
  font-weight:600;
  cursor:pointer;
}
.month-dow .dow-btn:hover{ background:#151a24; }
.month-dow .dow-btn.active{ background:#1b2240; color:#fff; }
  /* === App shell (sidebar + content) === */
.app{
  display:grid;
  grid-template-columns: 240px 1fr;
  min-height:100vh;
}

/* --- Week header polish --- */
.week .day-head{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:2px;
  padding:10px 8px;
  background:#111626;            /* darker than the grid so it pops */
  border-left:1px solid #1f2436;
  border-bottom:1px solid #1f2436;
  position:sticky; top:0; z-index:3;
}

.week .day-head .dow{
  font-size:11px;
  letter-spacing:.4px;
  text-transform:uppercase;
  font-weight:700;
  color:#b8c4dc;                 /* softer, not pure white */
  opacity:.95;
}

.week .day-head .date{
  font-size:13px;
  font-weight:800;
  color:#e7ecf7;
}

/* highlight today’s column header */
.week .day-head.today{
  background:#1a2242;
  box-shadow: inset 0 -2px 0 0 var(--accent);
}

/* make weekends slightly dimmer */
.week .day-head.weekend .dow{
  color:#9aa6c0;
  opacity:.9;
}

/* left time column slightly darker so the header strip lines up nicely */
.week .time-col{
  background:#0f1324;
  border-right:1px solid #1f2436;
}

/* subtle sticky shadow under the header strip */
.week .day-head::after{
  content:"";
  position:absolute;
  left:0; right:0; bottom:-1px; height:1px;
  background:linear-gradient(to bottom, rgba(0,0,0,.35), rgba(0,0,0,0));
  pointer-events:none;
}
  
@media (max-width: 960px){
  .app{ grid-template-columns: 1fr; }
  .sidebar{ position:sticky; top:0; z-index:5; }
}

.sidebar{
  background:#0c0f16;
  border-right:1px solid #1d2234;
  padding:14px 12px;
}
.brand{
  display:flex; align-items:center; gap:10px;
  padding:8px 10px; margin-bottom:10px; color:var(--text);
}
.brand .logo{ font-size:20px; }

.nav{ display:flex; flex-direction:column; gap:6px; }
.nav-item{
  text-align:left; border:none; cursor:pointer;
  background:transparent; color:#cfd6ea;
  padding:10px 12px; border-radius:10px; font-weight:600;
}
.nav-item:hover{ background:#151a24; }
.nav-item.active{ background:#1b2240; color:#fff; box-shadow:inset 0 0 0 1px #2e4aa3; }

/* The top header you already have should stick as before when inside .app-content */
</style>
</head>
<body>

  <div class="app">
  <aside class="sidebar">
    <nav class="nav">
      <button class="nav-item active" data-view="scheduling">Scheduling</button>
      <button class="nav-item" data-view="greeting">Greeting</button>
      <button class="nav-item" data-view="advanced">Advanced</button>
      <button class="nav-item" data-view="logs">Logs</button>
    </nav>
  </aside>

  <div class="app-content">

<main>
  <section class="view" data-view="scheduling">

<header>
    <div class="row">
      <div class="ctrl">
        <label>Business hours</label>
        <div class="row" style="gap:6px">
          <input id="startHour" type="time" value="09:00">
          <input id="endHour" type="time" value="18:00">
        </div>
      </div>
    </div>
  </header>
    
  <!-- WEEK SCHEDULER -->
  <section class="card">
    <header>
      <h2>Weekly Availability</h2>
      <div class="legend">
        <span class="chip"><span class="dot unavail"></span> Unavailable slot</span>
        <span class="chip"><span class="dot block"></span> Blackout day</span>
      </div>
      <!-- NEW: week controls styled like the month controls -->
      <div class="month-controls" id="weekControls">
        <button class="secondary" id="prevWeek">◀</button>
        <div id="weekTitle" class="hint">Week</div>
        <button class="secondary" id="nextWeek">▶</button>
        <button class="danger" id="clearWeek">Clear All</button>
      </div>
    </header>
    <div class="week-wrap">
      <div id="week" class="week"></div>
    </div>
    <div style="padding:10px 14px;border-top:1px solid #21263a" class="hint">
      Tip: Click or click-drag to mark times you are <b>unavailable</b>. Blackout days (from the month view) are disabled here.
    </div>
  </section>

  <!-- MONTH BLACKOUTS -->
  <section class="card">
    <header>
      <h2>Blackout Days</h2>
      <div class="month-controls">
        <button class="secondary" id="prevMon">◀</button>
        <div id="monTitle" class="hint">Month YYYY</div>
        <button class="secondary" id="nextMon">▶</button>
        <button class="danger" id="clearBlackouts">Clear All</button>
      </div>
    </header>
    <div style="padding:8px 12px;color:var(--muted)">Click any day to toggle a full-day blackout (no bookings).</div>
    <div id="monthDow" class="month-dow"></div>
    <div id="month" class="month-grid"></div>
  </section>
  <div class="inline-actions">
    <button id="todayBtn" class="secondary">Jump to Today</button>
  </div>
    
 </section>
  <section class="view" data-view="greeting" hidden>
  <section class="card">
    <header><h2>Greeting</h2></header>
    <div style="padding:14px">
      <p class="hint">Customize what the bot says when it answers.</p>
      <div style="display:flex; gap:10px; margin-top:8px;">
        <input id="greetingInput2" type="text" style="flex:1"
               placeholder="Hello, thank you for calling the barbershop! How can I help you today.">
        <button id="saveGreeting2">Save</button>
      </div>
    </div>
  </section>
</section>

<section class="view" data-view="advanced" hidden>
  <section class="card">
    <header><h2>Advanced Features</h2></header>
    <div style="padding:14px">
      <p class="hint">Add things like “Temporary disable”, “Time controls”, or “Extension digits”.</p>
    </div>
  </section>
</section>

<section class="view" data-view="logs" hidden>
  <section class="card">
    <header><h2>Logs</h2></header>
    <div style="padding:14px">
      <p class="hint">Space for call logs or recent actions.</p>
    </div>
  </section>
</section>
</main>

<footer>
  <div>
    <div class="hint">Data auto-saves in your browser.</div>
  </div>
</footer>

<script>
/* ---------- Utilities ---------- */
const fmtDate = (d)=> new Date(d.getTime() - d.getTimezoneOffset()*60000).toISOString().slice(0,10);
const pad = n => String(n).padStart(2,'0');
function minutesBetween(a,b){ return Math.max(0, Math.round((b-a)/60000)); }
function addMinutes(date, m){ return new Date(date.getTime()+m*60000); }
function weekStart(d){
  const x = new Date(d);
  const day = x.getDay();      // Sun=0, Mon=1, ... Sat=6
  x.setHours(0,0,0,0);
  x.setDate(x.getDate() - day); // back to Sunday
  return x;
}
function clone(d){ return new Date(d.getTime()); }
function tzLocalISO(date){ // yyyy-mm-ddTHH:MM (local)
  const z = new Date(date.getTime()-date.getTimezoneOffset()*60000);
  return z.toISOString().slice(0,16);
}

/* ---------- State ---------- */
const storeKey = "barber_gui_state_v1";
let state = {
  slotLen: 15,
  start: "09:00",
  end: "18:00",
  // availability: { 'YYYY-MM-DD': { 'HH:MM': true, ... } }
  availability: {},
  // blackoutDays: Set<string>
  blackoutDays: {},
  // cursors
  weekCursor: weekStart(new Date()),
  monthCursor: new Date(new Date().getFullYear(), new Date().getMonth(), 1),

  greeting: "Hello, thank you for calling the barbershop! How can I help you today."
};
function save(){ localStorage.setItem(storeKey, JSON.stringify(state)); }
function load(){
  try{
    const raw = localStorage.getItem(storeKey);
    if(!raw) return;
    const s = JSON.parse(raw);
    // merge sensibly
    state = {
      ...state,
      ...s,
      weekCursor: s.weekCursor ? new Date(s.weekCursor) : state.weekCursor,
      monthCursor: s.monthCursor ? new Date(s.monthCursor) : state.monthCursor,
      greeting: typeof s.greeting === "string" ? s.greeting : state.greeting
    };
  }catch{}
}
load();

/* ---------- DOM refs ---------- */
const startHour = document.getElementById('startHour');
const endHour = document.getElementById('endHour');
const weekEl = document.getElementById('week');
const prevWeek = document.getElementById('prevWeek');
const nextWeek = document.getElementById('nextWeek');
const clearWeek = document.getElementById('clearWeek');
const weekTitle = document.getElementById('weekTitle');
const todayBtn = document.getElementById('todayBtn');

const monTitle = document.getElementById('monTitle');
const monthEl = document.getElementById('month');
const prevMon = document.getElementById('prevMon');
const nextMon = document.getElementById('nextMon');
const clearBlackouts = document.getElementById('clearBlackouts');


  /* === Left-nav view router === */
function showView(name){
  document.querySelectorAll('.nav-item').forEach(b=>{
    b.classList.toggle('active', b.dataset.view === name);
  });
  document.querySelectorAll('.view').forEach(v=>{
    v.hidden = v.dataset.view !== name;
  });
  // optional: location.hash = name;
}
document.querySelectorAll('.nav-item').forEach(b=>{
  b.addEventListener('click', ()=> showView(b.dataset.view));
});

// Initial view (hash or default)
showView((location.hash && location.hash.slice(1)) || 'scheduling');
window.addEventListener('hashchange', ()=> showView(location.hash.slice(1) || 'scheduling'));

/* ---------- Init controls ---------- */
startHour.value = state.start;
endHour.value   = state.end;

/* ---------- 12hr time ---------- */
function formatTime12h(hours, minutes = 0) {
  const ampm = hours >= 12 ? "PM" : "AM";
  let h = hours % 12;
  if (h === 0) h = 12;
  const m = minutes.toString().padStart(2, "0");
  return `${h}:${m} ${ampm}`;
}

  /* ---------- helper for formatting ---------- */
  function formatWeekRangeLabel(weekStartDate){
  const start = new Date(weekStartDate);
  const end = addMinutes(start, 6*24*60); // +6 days
  const opts = { month:'short', day:'numeric' };
  const s = start.toLocaleDateString(undefined, opts);
  const e = end.toLocaleDateString(undefined, opts);
  return `${s} – ${e}`;
}

/* ---------- Week view rendering ---------- */
function renderWeek(){
  const slot = 15;   
  const [sh, sm] = state.start.split(':').map(Number);
  const [eh, em] = state.end.split(':').map(Number);

  const startMins = sh*60 + sm;
  const endMins   = eh*60 + em;
  if (endMins <= startMins) return; // invalid config guard

  const rows = Math.ceil((endMins-startMins)/slot);
  const days = Array.from({length:7},(_,i)=> addMinutes(state.weekCursor, i*24*60));
  if (weekTitle) {
    weekTitle.textContent = formatWeekRangeLabel(state.weekCursor);
  }
  weekEl.innerHTML = "";
  weekEl.style.gridTemplateRows = `40px repeat(${rows}, 20px)`;
  

  // top-left header spacer
  const topLeft = document.createElement('div');
  topLeft.className = "day-head time-cell";
  topLeft.style.gridColumn = "1";
  topLeft.style.gridRow = "1";
  weekEl.appendChild(topLeft);

  // time column (sticks on the left, spans all rows beneath headers)
  const timeCol = document.createElement('div');
  timeCol.className = "time-col";
  timeCol.style.gridColumn = "1";
  timeCol.style.gridRow = `2 / span ${rows}`; 

  const timeLabels = document.createElement('div');
  timeLabels.style.display = "grid";
  timeLabels.style.gridAutoRows = "20px";
  for(let r=0;r<rows;r++){
    const t = startMins + r*slot;
    if (t % 60 === 0) {
      const lab = document.createElement('div');
      lab.className="time-label";
      lab.textContent = formatTime12h(Math.floor(t/60), 0);
      timeLabels.appendChild(lab);
    } else {
      const spacer = document.createElement('div');
      spacer.style.height="20px";
      spacer.style.borderBottom="1px dashed #1e2435";
      timeLabels.appendChild(spacer);
    }
  }
  timeCol.appendChild(timeLabels);
  weekEl.appendChild(timeCol);

  // day headers
  const dowNames = ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];
  days.forEach((d,idx)=>{
    const h = document.createElement('div');
    h.className = "day-head";
    const disp = d.toLocaleDateString(undefined,{month:'short', day:'numeric'});
    h.innerHTML = `<div class="dow">${dowNames[idx]}</div><div class="date">${disp}</div>`;
    h.style.gridColumn = String(idx+2);
    h.style.gridRow = "1";
    weekEl.appendChild(h);
  });

  // slots (7 day columns)
  let isDragging = false;
  let dragMode = null; // true => activating, false => deactivating
  
  const onDown = (e, dateStr, timeStr, cell) => {
    if (state.blackoutDays[dateStr]) return;
    isDragging = true;
    const cur = !!(state.availability?.[dateStr]?.[timeStr]);
    dragMode = !cur; // toggle intent
    toggleSlot(dateStr, timeStr, dragMode);
    cell.classList.toggle('active', dragMode);
  };
  const onOver = (e, dateStr, timeStr, cell) => {
    if (!isDragging) return;
    if (state.blackoutDays[dateStr]) return;
    toggleSlot(dateStr, timeStr, dragMode);
    cell.classList.toggle('active', dragMode);
  };
  const onUp = ()=>{ isDragging=false; dragMode=null; save(); };
  document.addEventListener('mouseup', onUp, { once:false });
  
  // ✅ Create ONE column per day, then fill it with row cells
  days.forEach((d, dayIdx) => {
    const dateStr = fmtDate(d);
    const col = document.createElement('div');
    col.className = "slots";
    col.style.gridColumn = String(dayIdx + 2); // col 1 is the time labels
    col.style.gridRow = `2 / span ${rows}`;             // span all time rows
  
    for (let r = 0; r < rows; r++) {
      const mins = startMins + r * slot;
      const hours = Math.floor(mins / 60), minutes = mins % 60;
      const timeStr = `${pad(hours)}:${pad(minutes)}`;
  
      const cell = document.createElement('div');
      cell.className = "slot";
  
      if (state.blackoutDays[dateStr]) cell.classList.add('blocked');
      if (state.availability?.[dateStr]?.[timeStr]) cell.classList.add('active');
  
      cell.addEventListener('mousedown', (e)=>onDown(e,dateStr,timeStr,cell));
      cell.addEventListener('mouseenter', (e)=>onOver(e,dateStr,timeStr,cell));
  
      if (minutes === 0) {
        const tag = document.createElement('div');
        tag.className = "tag";
        tag.textContent = formatTime12h(hours, minutes); // 12h labels
        cell.appendChild(tag);
      }
  
      col.appendChild(cell);
    }
  
    weekEl.appendChild(col);
  });
}

function toggleSlot(dateStr, timeStr, isUnavailable){
  state.availability[dateStr] = state.availability[dateStr] || {};
  if (isUnavailable) state.availability[dateStr][timeStr] = true;
  else delete state.availability[dateStr][timeStr];
  if (Object.keys(state.availability[dateStr]).length===0) delete state.availability[dateStr];
}

  function toggleWeekdayForMonth(dow){
  const cur = state.monthCursor;
  const y = cur.getFullYear();
  const m = cur.getMonth();
  const last = new Date(y, m + 1, 0).getDate(); // last day in month (1..28/29/30/31)

  // Collect all dates in this month that match the weekday
  const keys = [];
  for(let day=1; day<=last; day++){
    const d = new Date(y, m, day);
    if (d.getDay() === dow) keys.push(fmtDate(d));
  }

  // If *every* matching day is already blacked out, we will un-block; otherwise, block all.
  const allBlocked = keys.every(k => !!state.blackoutDays[k]);
  const willBlock = !allBlocked;

  if (willBlock) {
    for (const k of keys) {
      state.blackoutDays[k] = true;
      delete state.availability[k]; // wipe availability on those days
    }
  } else {
    for (const k of keys) {
      delete state.blackoutDays[k];
      // (leave availability alone on un-block; user can toggle slots)
    }
  }

  save();
  renderMonth();
  renderWeek();
}

/* ---------- Month view rendering ---------- */
function renderMonth(){
  const cur = state.monthCursor;
  const y = cur.getFullYear();
  const m = cur.getMonth();
  const first = new Date(y,m,1);
  monTitle.textContent = first.toLocaleString(undefined,{month:'long', year:'numeric'});

  // draw weekday header (Sun–Sat) as buttons
  const dowHdr = document.getElementById('monthDow');
  dowHdr.innerHTML = "";
  ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].forEach((txt, dow)=>{
    const b = document.createElement('button');
    b.type = "button";
    b.className = "dow-btn";
    b.textContent = txt;
    b.dataset.dow = String(dow);     // 0..6
    b.title = `Toggle all ${txt}s this month`;
    b.addEventListener('click', ()=> toggleWeekdayForMonth(dow));
    dowHdr.appendChild(b);
  });

  // start on Monday
  const startOffset = first.getDay();
  const startCellDate = new Date(y,m,1 - startOffset);
  const totalCells = 42; // 6 weeks grid

  monthEl.innerHTML = "";
  for(let i=0;i<totalCells;i++){
    const d = new Date(startCellDate); d.setDate(d.getDate()+i);
    const inMonth = d.getMonth()===m;
    const key = fmtDate(d);
    const cell = document.createElement('div');
    cell.className = "cell";
    if (!inMonth) cell.classList.add('dim');
    if (state.blackoutDays[key]) cell.classList.add('blockout');

    cell.innerHTML = `<div class="d">${d.getDate()}</div>`;
    cell.addEventListener('click', ()=>{
      // toggle blackout
      if (state.blackoutDays[key]) {
        delete state.blackoutDays[key];
      } else {
        state.blackoutDays[key] = true;
        // wipe any availability on that day
        delete state.availability[key];
      }
      save();
      renderMonth();
      renderWeek();
    });

    monthEl.appendChild(cell);
  }
}

/* ---------- Wire controls ---------- */
[startHour, endHour].forEach(inp=>{
  inp.addEventListener('change', ()=>{
    state.start = startHour.value;
    state.end   = endHour.value;
    save(); renderWeek();
  });
});

prevWeek.addEventListener('click', ()=>{
  state.weekCursor = addMinutes(state.weekCursor, -7*24*60);
  save(); renderWeek();
});
nextWeek.addEventListener('click', ()=>{
  state.weekCursor = addMinutes(state.weekCursor, 7*24*60);
  save(); renderWeek();
});
clearWeek.addEventListener('click', ()=>{
  const days = Array.from({length:7},(_,i)=> fmtDate(addMinutes(state.weekCursor, i*24*60)));
  days.forEach(d=> delete state.availability[d]);
  save(); renderWeek();
});

prevMon.addEventListener('click', ()=>{ state.monthCursor = new Date(state.monthCursor.getFullYear(), state.monthCursor.getMonth()-1, 1); save(); renderMonth(); });
nextMon.addEventListener('click', ()=>{ state.monthCursor = new Date(state.monthCursor.getFullYear(), state.monthCursor.getMonth()+1, 1); save(); renderMonth(); });
clearBlackouts.addEventListener('click', ()=>{
  state.blackoutDays = {};
  save(); renderMonth(); renderWeek();
});


/* ---------- First paint ---------- */
renderWeek();
renderMonth();

/* ---------- Sanity checks (light tests in console) ---------- */
(function runSanity(){
  const cols = document.querySelectorAll('#week .slots').length;
  console.assert(cols === 7, `Expected 7 day columns, got ${cols}`);
  const heads = document.querySelectorAll('#week .day-head').length;
  console.assert(heads === 8, `Expected 8 headers (including top-left), got ${heads}`);
})();

/* ---------- Public API (future backend hook) ----------
window.getSchedulePayload = () => ({
  slotLen: state.slotLen,
  start: state.start,
  end: state.end,
  availability: state.availability,
  blackoutDays: state.blackoutDays
});
------------------------------------------------------ */
</script>
    </div> <!-- /.app-content -->
</div>   <!-- /.app -->
</body>
</html>
